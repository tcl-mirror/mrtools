<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: wmachine Pages: 1 -->
<svg width="449pt" height="720pt"
 viewBox="0.00 0.00 449.24 720.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.435308 0.435308) rotate(0) translate(4 1650)">
<title>wmachine</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-1650 1029,-1650 1029,5 -4,5"/>
<!-- Idle -->
<g id="node1" class="node"><title>Idle</title>
<polygon fill="none" stroke="black" points="318,-1646 264,-1646 264,-1610 318,-1610 318,-1646"/>
<text text-anchor="middle" x="291" y="-1624.4" font-family="Times Roman,serif" font-size="14.00">Idle</text>
</g>
<!-- FillingForWashing -->
<g id="node2" class="node"><title>FillingForWashing</title>
<polygon fill="none" stroke="black" points="136,-1396 4.17097e-14,-1396 -6.10623e-16,-1360 136,-1360 136,-1396"/>
<text text-anchor="middle" x="68" y="-1374.4" font-family="Times Roman,serif" font-size="14.00">FillingForWashing</text>
</g>
<!-- Idle&#45;&gt;FillingForWashing -->
<g id="edge2" class="edge"><title>Idle&#45;&gt;FillingForWashing</title>
<path fill="none" stroke="black" d="M263.889,-1625.99C203.103,-1621.22 60.1218,-1608.35 46,-1592 -5.71417,-1532.13 24.5728,-1490.15 46,-1414 46.8456,-1410.99 48.0196,-1407.99 49.3891,-1405.07"/>
<polygon fill="black" stroke="black" points="52.5438,-1406.6 54.2672,-1396.15 46.4009,-1403.24 52.5438,-1406.6"/>
<text text-anchor="start" x="46" y="-1579.4" font-family="Times Roman,serif" font-size="14.00">Run {} {</text>
<text text-anchor="start" x="46" y="-1561.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Open water valve</text>
<text text-anchor="start" x="46" y="-1543.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Opening water valve&quot;</text>
<text text-anchor="start" x="46" y="-1509.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# At this point we need the washing tub sensor to tell us that the</text>
<text text-anchor="start" x="46" y="-1491.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# tub is full. For simplicity, we will simulate the sensor by</text>
<text text-anchor="start" x="46" y="-1473.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# means of the Tcl &quot;after&quot; command.</text>
<text text-anchor="start" x="46" y="-1455.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# SIMULATING THE TUB SENSOR</text>
<text text-anchor="start" x="46" y="-1437.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;after 5000 [list mealy generate {} &#45; Full &#45;&gt; $self]</text>
<text text-anchor="start" x="46" y="-1419.4" font-family="Times Roman,serif" font-size="14.00">}</text>
</g>
<!-- Agitating -->
<g id="node3" class="node"><title>Agitating</title>
<polygon fill="none" stroke="black" points="154,-1180 74,-1180 74,-1144 154,-1144 154,-1180"/>
<text text-anchor="middle" x="114" y="-1158.4" font-family="Times Roman,serif" font-size="14.00">Agitating</text>
</g>
<!-- FillingForWashing&#45;&gt;Agitating -->
<g id="edge4" class="edge"><title>FillingForWashing&#45;&gt;Agitating</title>
<path fill="none" stroke="black" d="M71.8428,-1359.96C79.859,-1322.31 98.4139,-1235.19 108.011,-1190.12"/>
<polygon fill="black" stroke="black" points="111.476,-1190.65 110.136,-1180.15 104.63,-1189.2 111.476,-1190.65"/>
<text text-anchor="start" x="107" y="-1329.4" font-family="Times Roman,serif" font-size="14.00">Full {} {</text>
<text text-anchor="start" x="107" y="-1311.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Close water value</text>
<text text-anchor="start" x="107" y="-1293.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Closing water valve&quot;</text>
<text text-anchor="start" x="107" y="-1275.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Set motor to agitate</text>
<text text-anchor="start" x="107" y="-1257.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Setting motor to agitate&quot;</text>
<text text-anchor="start" x="107" y="-1239.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Generate &quot;Done&quot; to self delayed by the wash time.</text>
<text text-anchor="start" x="107" y="-1221.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;mealy delay [$self cget wash] $self &#45; Done &#45;&gt; $self</text>
<text text-anchor="start" x="107" y="-1203.4" font-family="Times Roman,serif" font-size="14.00">}</text>
</g>
<!-- EmptyingWashWater -->
<g id="node4" class="node"><title>EmptyingWashWater</title>
<polygon fill="none" stroke="black" points="218,-948 56,-948 56,-912 218,-912 218,-948"/>
<text text-anchor="middle" x="137" y="-926.4" font-family="Times Roman,serif" font-size="14.00">EmptyingWashWater</text>
</g>
<!-- Agitating&#45;&gt;EmptyingWashWater -->
<g id="edge6" class="edge"><title>Agitating&#45;&gt;EmptyingWashWater</title>
<path fill="none" stroke="black" d="M115.805,-1143.8C119.802,-1103.48 129.425,-1006.41 134.206,-958.18"/>
<polygon fill="black" stroke="black" points="137.7,-958.417 135.204,-948.12 130.734,-957.726 137.7,-958.417"/>
<text text-anchor="start" x="134" y="-1113.4" font-family="Times Roman,serif" font-size="14.00">Done {} {</text>
<text text-anchor="start" x="134" y="-1095.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Stop motor</text>
<text text-anchor="start" x="134" y="-1077.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Stopping motor&quot;</text>
<text text-anchor="start" x="134" y="-1059.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Start pump</text>
<text text-anchor="start" x="134" y="-1041.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Starting pump&quot;</text>
<text text-anchor="start" x="134" y="-1007.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# SIMULATING THE TUB SENSOR</text>
<text text-anchor="start" x="134" y="-989.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;after 5000 [list mealy generate {} &#45; Empty &#45;&gt; $self]</text>
<text text-anchor="start" x="134" y="-971.4" font-family="Times Roman,serif" font-size="14.00">}</text>
</g>
<!-- FillingForRinse -->
<g id="node5" class="node"><title>FillingForRinse</title>
<polygon fill="none" stroke="black" points="201,-700 85,-700 85,-664 201,-664 201,-700"/>
<text text-anchor="middle" x="143" y="-678.4" font-family="Times Roman,serif" font-size="14.00">FillingForRinse</text>
</g>
<!-- EmptyingWashWater&#45;&gt;FillingForRinse -->
<g id="edge8" class="edge"><title>EmptyingWashWater&#45;&gt;FillingForRinse</title>
<path fill="none" stroke="black" d="M137.441,-911.764C138.477,-868.947 141.071,-761.732 142.314,-710.339"/>
<polygon fill="black" stroke="black" points="145.815,-710.345 142.558,-700.263 138.817,-710.175 145.815,-710.345"/>
<text text-anchor="start" x="142" y="-881.4" font-family="Times Roman,serif" font-size="14.00">Empty {} {</text>
<text text-anchor="start" x="142" y="-863.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Stop pump</text>
<text text-anchor="start" x="142" y="-845.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Stopping pump&quot;</text>
<text text-anchor="start" x="142" y="-827.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Open water valve</text>
<text text-anchor="start" x="142" y="-809.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Opening water valve&quot;</text>
<text text-anchor="start" x="142" y="-759.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# SIMULATING THE TUB SENSOR</text>
<text text-anchor="start" x="142" y="-741.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;after 5000 [list mealy generate {} &#45; Full &#45;&gt; $self]</text>
<text text-anchor="start" x="142" y="-723.4" font-family="Times Roman,serif" font-size="14.00">}</text>
</g>
<!-- Rinsing -->
<g id="node6" class="node"><title>Rinsing</title>
<polygon fill="none" stroke="black" points="177,-484 111,-484 111,-448 177,-448 177,-484"/>
<text text-anchor="middle" x="144" y="-462.4" font-family="Times Roman,serif" font-size="14.00">Rinsing</text>
</g>
<!-- FillingForRinse&#45;&gt;Rinsing -->
<g id="edge10" class="edge"><title>FillingForRinse&#45;&gt;Rinsing</title>
<path fill="none" stroke="black" d="M143.084,-663.955C143.257,-626.394 143.659,-539.554 143.868,-494.41"/>
<polygon fill="black" stroke="black" points="147.37,-494.161 143.916,-484.145 140.37,-494.129 147.37,-494.161"/>
<text text-anchor="start" x="144" y="-633.4" font-family="Times Roman,serif" font-size="14.00">Full {} {</text>
<text text-anchor="start" x="144" y="-615.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Close water valve</text>
<text text-anchor="start" x="144" y="-597.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Closing water valve&quot;</text>
<text text-anchor="start" x="144" y="-579.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Set motor to agitate</text>
<text text-anchor="start" x="144" y="-561.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Setting motor to agitate&quot;</text>
<text text-anchor="start" x="144" y="-543.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Generate Done to self delayed by the rinse time</text>
<text text-anchor="start" x="144" y="-525.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;mealy delay [$self cget rinse] $self &#45; Done &#45;&gt; $self</text>
<text text-anchor="start" x="144" y="-507.4" font-family="Times Roman,serif" font-size="14.00">}</text>
</g>
<!-- EmptyingRinseWater -->
<g id="node7" class="node"><title>EmptyingRinseWater</title>
<polygon fill="none" stroke="black" points="230,-252 68,-252 68,-216 230,-216 230,-252"/>
<text text-anchor="middle" x="149" y="-230.4" font-family="Times Roman,serif" font-size="14.00">EmptyingRinseWater</text>
</g>
<!-- Rinsing&#45;&gt;EmptyingRinseWater -->
<g id="edge12" class="edge"><title>Rinsing&#45;&gt;EmptyingRinseWater</title>
<path fill="none" stroke="black" d="M143.455,-447.875C142.555,-413.267 141.211,-335.395 145,-270 145.141,-267.563 145.332,-265.038 145.553,-262.507"/>
<polygon fill="black" stroke="black" points="149.063,-262.585 146.591,-252.282 142.099,-261.878 149.063,-262.585"/>
<text text-anchor="start" x="145" y="-417.4" font-family="Times Roman,serif" font-size="14.00">Done {} {</text>
<text text-anchor="start" x="145" y="-399.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Stop motor</text>
<text text-anchor="start" x="145" y="-381.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Stopping motor&quot;</text>
<text text-anchor="start" x="145" y="-363.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Start pump</text>
<text text-anchor="start" x="145" y="-345.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Starting pump&quot;</text>
<text text-anchor="start" x="145" y="-311.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# SIMULATING THE TUB SENSOR</text>
<text text-anchor="start" x="145" y="-293.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;after 5000 [list mealy generate {} &#45; Empty &#45;&gt; $self]</text>
<text text-anchor="start" x="145" y="-275.4" font-family="Times Roman,serif" font-size="14.00">}</text>
</g>
<!-- Spinning -->
<g id="node8" class="node"><title>Spinning</title>
<polygon fill="none" stroke="black" points="385,-36 309,-36 309,-1.06581e-14 385,-0 385,-36"/>
<text text-anchor="middle" x="347" y="-14.4" font-family="Times Roman,serif" font-size="14.00">Spinning</text>
</g>
<!-- EmptyingRinseWater&#45;&gt;Spinning -->
<g id="edge14" class="edge"><title>EmptyingRinseWater&#45;&gt;Spinning</title>
<path fill="none" stroke="black" d="M143.959,-215.997C135.142,-180.225 121.469,-99.7163 162,-54 179.732,-33.9994 250.181,-24.8648 298.837,-20.8731"/>
<polygon fill="black" stroke="black" points="299.162,-24.3585 308.862,-20.0973 298.622,-17.3793 299.162,-24.3585"/>
<text text-anchor="start" x="162" y="-185.4" font-family="Times Roman,serif" font-size="14.00">Empty {} {</text>
<text text-anchor="start" x="162" y="-167.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Stop pump</text>
<text text-anchor="start" x="162" y="-149.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Stopping pump&quot;</text>
<text text-anchor="start" x="162" y="-131.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Set motor to spin</text>
<text text-anchor="start" x="162" y="-113.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Setting motor to spin&quot;</text>
<text text-anchor="start" x="162" y="-95.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Generate Done to self delayed by the spin time</text>
<text text-anchor="start" x="162" y="-77.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;mealy delay [$self cget spin] $self &#45; Done &#45;&gt; $self</text>
<text text-anchor="start" x="162" y="-59.4" font-family="Times Roman,serif" font-size="14.00">}</text>
</g>
<!-- Spinning&#45;&gt;Idle -->
<g id="edge16" class="edge"><title>Spinning&#45;&gt;Idle</title>
<path fill="none" stroke="black" d="M385.088,-20.4899C431.519,-24.3813 506.035,-33.6769 524,-54 577.144,-114.12 538,-153.758 538,-234 538,-1378 538,-1378 538,-1378 538,-1473.31 588.369,-1521.7 524,-1592 510.967,-1606.23 390.688,-1619.03 328.248,-1624.79"/>
<polygon fill="black" stroke="black" points="327.667,-1621.32 318.024,-1625.71 328.299,-1628.3 327.667,-1621.32"/>
<text text-anchor="start" x="538" y="-873.4" font-family="Times Roman,serif" font-size="14.00">Done {} {</text>
<text text-anchor="start" x="538" y="-855.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# Stop motor</text>
<text text-anchor="start" x="538" y="-837.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;puts &quot;$self: Stopping motor&quot;</text>
<text text-anchor="start" x="538" y="-803.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# For testing purpose, we want to be able to run the Tcl event loop</text>
<text text-anchor="start" x="538" y="-785.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# and when we are done with the cycle we will use &quot;vwait&quot; to</text>
<text text-anchor="start" x="538" y="-767.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;# determine that we have finished.</text>
<text text-anchor="start" x="538" y="-749.4" font-family="Times Roman,serif" font-size="14.00"> &#160;&#160;&#160;set ::wmachine($self) Idle</text>
<text text-anchor="start" x="538" y="-731.4" font-family="Times Roman,serif" font-size="14.00">}</text>
</g>
</g>
</svg>
