<html><head>
<title>rosea - XUML Data and Execution Architecture</title>
<style type="text/css"><!--
    HTML {
	background: 	#FFFFFF;
	color: 		black;
    }
    BODY {
	background: 	#FFFFFF;
	color:	 	black;
    }
    DIV.doctools {
	margin-left:	10%;
	margin-right:	10%;
    }
    DIV.doctools H1,DIV.doctools H2 {
	margin-left:	-5%;
    }
    H1, H2, H3, H4 {
	margin-top: 	1em;
	font-family:	sans-serif;
	font-size:	large;
	color:		#005A9C;
	background: 	transparent;
	text-align:		left;
    }
    H1.title {
	text-align: center;
    }
    UL,OL {
	margin-right: 0em;
	margin-top: 3pt;
	margin-bottom: 3pt;
    }
    UL LI {
	list-style: disc;
    }
    OL LI {
	list-style: decimal;
    }
    DT {
	padding-top: 	1ex;
    }
    UL.toc,UL.toc UL, UL.toc UL UL {
	font:		normal 12pt/14pt sans-serif;
	list-style:	none;
    }
    LI.section, LI.subsection {
	list-style: 	none;
	margin-left: 	0em;
	text-indent:	0em;
	padding: 	0em;
    }
    PRE {
	display: 	block;
	font-family:	monospace;
	white-space:	pre;
	margin:		0%;
	padding-top:	0.5ex;
	padding-bottom:	0.5ex;
	padding-left:	1ex;
	padding-right:	1ex;
	width:		100%;
    }
    PRE.example {
	color: 		black;
	background: 	#f5dcb3;
	border:		1px solid black;
    }
    UL.requirements LI, UL.syntax LI {
	list-style: 	none;
	margin-left: 	0em;
	text-indent:	0em;
	padding:	0em;
    }
    DIV.synopsis {
	color: 		black;
	background: 	#80ffff;
	border:		1px solid black;
	font-family:	serif;
	margin-top: 	1em;
	margin-bottom: 	1em;
    }
    UL.syntax {
	margin-top: 	1em;
	border-top:	1px solid black;
    }
    UL.requirements {
	margin-bottom: 	1em;
	border-bottom:	1px solid black;
    }
--></style>
</head>
<! -- Generated from file 'rosea.man' by tcllib/doctools with format 'html'
   -->
<! -- Copyright &copy; 2014-2015 by G. Andrew Mangogna
   -->
<! -- CVS: $Id$ rosea.n
   -->
<body><div class="doctools">
<h1 class="title">rosea(n) 1.6.5 rosea &quot;XUML Data and Execution Architecture&quot;</h1>
<div id="name" class="section"><h2><a name="name">Name</a></h2>
<p>rosea - Relation Oriented Software Execution Architecture</p>
</div>
<div id="toc" class="section"><h2><a name="toc">Table Of Contents</a></h2>
<ul class="toc">
<li class="section"><a href="#toc">Table Of Contents</a></li>
<li class="section"><a href="#synopsis">Synopsis</a></li>
<li class="section"><a href="#section1">Description</a></li>
<li class="section"><a href="#section2">Package Commands</a></li>
<li class="section"><a href="#section3">Configuration Commands</a>
<ul>
<li class="subsection"><a href="#subsection1">Domain Configuration Commands</a></li>
<li class="subsection"><a href="#subsection2">Class Configuration Commands</a></li>
<li class="subsection"><a href="#subsection3">State Model Configuration Commands</a></li>
<li class="subsection"><a href="#subsection4">Assigner Configuration Commands</a></li>
</ul>
</li>
<li class="section"><a href="#section4">Population Commands</a>
<ul>
<li class="subsection"><a href="#subsection5">Domain Population Commands</a></li>
</ul>
</li>
<li class="section"><a href="#section5">Architecture Commands</a>
<ul>
<li class="subsection"><a href="#subsection6">Class Commands</a></li>
<li class="subsection"><a href="#subsection7">Relationship Commands</a></li>
<li class="subsection"><a href="#subsection8">Instance Commands</a></li>
</ul>
</li>
<li class="section"><a href="#copyright">Copyright</a></li>
</ul>
</div>
<div id="synopsis" class="section"><h2><a name="synopsis">Synopsis</a></h2>
<div class="synopsis">
<ul class="requirements">
<li>package require <b class="pkgname">rosea <span class="opt">?1.6.5?</span></b></li>
</ul>
<ul class="syntax">
<li>Package Commands</li>
<li><a href="#1"><b class="cmd">::rosea configure</b> <i class="arg">script</i></a></li>
<li><a href="#2"><b class="cmd">::rosea configureFromChan</b> <i class="arg">channel</i></a></li>
<li><a href="#3"><b class="cmd">::rosea configureFromFile</b> <i class="arg">filename</i></a></li>
<li><a href="#4"><b class="cmd">::rosea generate</b> <span class="opt">?<i class="arg">pattern</i>?</span> <span class="opt">?<i class="arg">nsqual</i>?</span></a></li>
<li><a href="#5"><b class="cmd">::rosea populate</b> <i class="arg">script</i></a></li>
<li><a href="#6"><b class="cmd">::rosea populateFromChan</b> <i class="arg">channel</i></a></li>
<li><a href="#7"><b class="cmd">::rosea populateFromFile</b> <i class="arg">filename</i></a></li>
<li><a href="#8"><b class="cmd">::rosea save</b> <span class="opt">?-sqlite | -tclral?</span> <span class="opt">?-async <i class="arg">cmdprefix</i>?</span> <i class="arg">domain</i> <i class="arg">filename</i></a></li>
<li><a href="#9"><b class="cmd">::rosea restore</b> <span class="opt">?-sqlite | -tclral?</span> <i class="arg">domain</i> <i class="arg">filename</i></a></li>
<li><a href="#10"><b class="cmd">::rosea info</b> <i class="arg">subcommand</i> <i class="arg">arg1 arg2 ...</i></a></li>
<li><a href="#11"><b class="cmd">::rosea::info domain classes</b> <i class="arg">domainname</i></a></li>
<li><a href="#12"><b class="cmd">::rosea::info domain relationships</b> <i class="arg">domainname</i></a></li>
<li><a href="#13"><b class="cmd">::rosea::info domain operations</b> <i class="arg">domainname</i></a></li>
<li><a href="#14"><b class="cmd">::rosea::info classes attributes</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></li>
<li><a href="#15"><b class="cmd">::rosea::info classes classops</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></li>
<li><a href="#16"><b class="cmd">::rosea::info classes instops</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></li>
<li><a href="#17"><b class="cmd">::rosea::info statemodel states</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></li>
<li><a href="#18"><b class="cmd">::rosea::info statemodel events</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></li>
<li><a href="#19"><b class="cmd">::rosea::info statemodel transitions</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></li>
<li><a href="#20"><b class="cmd">::rosea::info statemodel activityproc</b> <i class="arg">domainname</i> <i class="arg">classname</i> <i class="arg">statename</i></a></li>
<li><a href="#21"><b class="cmd">::rosea tunnel</b> <i class="arg">instref</i> <i class="arg">operation</i> <span class="opt">?<i class="arg">arg1 arg2 ...</i>?</span></a></li>
<li><a href="#22"><b class="cmd">::rosea trace</b> <i class="arg">subcmd</i> <span class="opt">?<i class="arg">value ...</i>?</span></a></li>
<li>Configuration Commands</li>
<li><a href="#23"><b class="cmd">domain</b> <i class="arg">name</i> <i class="arg">body</i></a></li>
<li>Domain Configuration Commands</li>
<li><a href="#24"><b class="cmd">class</b> <i class="arg">name</i> <i class="arg">script</i></a></li>
<li><a href="#25"><b class="cmd">association</b> <i class="arg">name</i> <i class="arg">source</i> <i class="arg">spec</i> <i class="arg">target</i> <span class="opt">?<i class="arg">option value ...</i>?</span></a></li>
<li><a href="#26"><b class="cmd">generalization</b> <i class="arg">name</i> <i class="arg">superclass</i> <i class="arg">subclass1</i> <i class="arg">subclass2 ...</i></a></li>
<li><a href="#27"><b class="cmd">assigner</b> <i class="arg">association</i> <i class="arg">body</i></a></li>
<li><a href="#28"><b class="cmd">operation</b> <i class="arg">name</i> <i class="arg">parameters</i> <i class="arg">body</i></a></li>
<li>Class Configuration Commands</li>
<li><a href="#29"><b class="cmd">attribute</b> <i class="arg">name</i> <i class="arg">datatype</i> <span class="opt">?<i class="arg">option value ...</i>?</span></a></li>
<li><a href="#30"><b class="cmd">reference</b> <i class="arg">relationship</i> <i class="arg">class</i> <span class="opt">?<i class="arg">option value ...</i>?</span></a></li>
<li><a href="#31"><b class="cmd">classop</b> <i class="arg">name</i> <i class="arg">params</i> <i class="arg">body</i></a></li>
<li><a href="#32"><b class="cmd">instop</b> <i class="arg">name</i> <i class="arg">params</i> <i class="arg">body</i></a></li>
<li><a href="#33"><b class="cmd">statemodel</b> <i class="arg">body</i></a></li>
<li><a href="#34"><b class="cmd">polymorphic</b> <span class="opt">?<i class="arg">event ...</i>?</span></a></li>
<li>State Model Configuration Commands</li>
<li><a href="#35"><b class="cmd">state</b> <i class="arg">name</i> <i class="arg">parameters</i> <i class="arg">body</i></a></li>
<li><a href="#36"><b class="cmd">transition</b> <i class="arg">source</i> <i class="arg">-</i> <i class="arg">event</i> <i class="arg">-&gt;</i> <i class="arg">target</i></a></li>
<li><a href="#37"><b class="cmd">initialstate</b> <i class="arg">name</i></a></li>
<li><a href="#38"><b class="cmd">defaulttrans</b> <i class="arg">CH | IG</i></a></li>
<li><a href="#39"><b class="cmd">terminal</b> <span class="opt">?<i class="arg">state ...</i>?</span></a></li>
<li>Assigner Configuration Commands</li>
<li><a href="#40"><b class="cmd">state</b> <i class="arg">name</i> <i class="arg">parameters</i> <i class="arg">body</i></a></li>
<li><a href="#41"><b class="cmd">transition</b> <i class="arg">source</i> <i class="arg">-</i> <i class="arg">event</i> <i class="arg">-&gt;</i> <i class="arg">target</i></a></li>
<li><a href="#42"><b class="cmd">initialstate</b> <i class="arg">name</i></a></li>
<li><a href="#43"><b class="cmd">defaulttrans</b> <i class="arg">CH | IG</i></a></li>
<li><a href="#44"><b class="cmd">identifyby</b> <i class="arg">class</i> <span class="opt">?<i class="arg">-id number</i>?</span></a></li>
<li>Population Commands</li>
<li><a href="#45"><b class="cmd">domain</b> <i class="arg">name</i> <i class="arg">body</i></a></li>
<li>Domain Population Commands</li>
<li><a href="#46"><b class="cmd">class</b> <i class="arg">name</i> <i class="arg">heading</i> <i class="arg">values ...</i></a></li>
<li><a href="#47"><b class="cmd">assigner</b> <i class="arg">association</i> <i class="arg">heading</i> <i class="arg">values ...</i></a></li>
<li>Class Commands</li>
<li><a href="#48"><i class="arg">class</i> <b class="cmd">findAll</b></a></li>
<li><a href="#49"><i class="arg">class</i> <b class="cmd">findById</b> <i class="arg">idattr1 idvalue1 ...</i></a></li>
<li><a href="#50"><i class="arg">class</i> <b class="cmd">findWhere</b> <i class="arg">expression</i></a></li>
<li><a href="#51"><i class="arg">class</i> <b class="cmd">create</b> <i class="arg">attr1 value1 attr2 value2 ...</i></a></li>
<li><a href="#52"><i class="arg">class</i> <b class="cmd">createin</b> <i class="arg">state</i> <i class="arg">attr1 value1 attr2 value2 ...</i></a></li>
<li><a href="#53"><i class="arg">class</i> <b class="cmd">createasync</b> <i class="arg">event</i> <i class="arg">eventparams</i> <i class="arg">attr1 value1 attr2 value2 ...</i></a></li>
<li><a href="#54"><i class="arg">class</i> <b class="cmd">update</b> <i class="arg">relationvalue</i></a></li>
<li>Relationship Commands</li>
<li><a href="#55"><i class="arg">relationship</i> <b class="cmd">link</b> <i class="arg">instref1</i> <i class="arg">instref2</i></a></li>
<li><a href="#56"><i class="arg">relationship</i> <b class="cmd">link</b> <i class="arg">instref1</i> <i class="arg">instref2</i> <span class="opt">?<i class="arg">attr1 value1 attr2 value2 ...</i>?</span></a></li>
<li><a href="#57"><i class="arg">relationship</i> <b class="cmd">unlink</b> <i class="arg">instref</i></a></li>
<li><a href="#58"><i class="arg">relationship</i> <b class="cmd">migrate</b> <i class="arg">instref</i> <i class="arg">subclass</i> <span class="opt">?<i class="arg">attr1 value1 attr2 value2 ...</i>?</span></a></li>
<li><a href="#59"><i class="arg">relationship</i> <b class="cmd">signal</b> <i class="arg">event</i> <span class="opt">?<i class="arg">param1 param2 ...</i>?</span></a></li>
<li><a href="#60"><i class="arg">relationship</i> <b class="cmd">signal</b> <i class="arg">idvalues</i> <i class="arg">event</i> <span class="opt">?<i class="arg">param1 param2 ...</i>?</span></a></li>
<li><a href="#61"><i class="arg">relationship</i> <b class="cmd">create</b> <span class="opt">?<i class="arg">attr1 value1 attr2 value2 ...</i>?</span></a></li>
<li>Instance Commands</li>
<li><a href="#62"><b class="cmd">deRef</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">attr1 attr2 ...</i>?</span></a></li>
<li><a href="#63"><b class="cmd">nilInstRef</b></a></li>
<li><a href="#64"><b class="cmd">isEmptyRef</b> <i class="arg">instref</i></a></li>
<li><a href="#65"><b class="cmd">isNotEmptyRef</b> <i class="arg">instref</i></a></li>
<li><a href="#66"><b class="cmd">refMultiplicity</b> <i class="arg">instref</i></a></li>
<li><a href="#67"><b class="cmd">isRefSingular</b> <i class="arg">instref</i></a></li>
<li><a href="#68"><b class="cmd">limitRef</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">count</i>?</span></a></li>
<li><a href="#69"><b class="cmd">isRefEqual</b> <i class="arg">instref1</i> <i class="arg">instref2</i></a></li>
<li><a href="#70"><b class="cmd">refUnion</b> <i class="arg">instref1</i> <i class="arg">instref2</i></a></li>
<li><a href="#71"><b class="cmd">refIntersect</b> <i class="arg">instref1</i> <i class="arg">instref2</i></a></li>
<li><a href="#72"><b class="cmd">refMinus</b> <i class="arg">instref1</i> <i class="arg">instref2</i></a></li>
<li><a href="#73"><b class="cmd">forAllRefs</b> <i class="arg">varname</i> <i class="arg">instref</i> <i class="arg">script</i></a></li>
<li><a href="#74"><b class="cmd">findRelated</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">relationship1 relationship2 ...</i>?</span></a></li>
<li><a href="#75"><b class="cmd">findUnrelated</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">relationship1 relationship2 ...</i>?</span></a></li>
<li><a href="#76"><b class="cmd">findRelatedWhere</b> <i class="arg">instref</i> <i class="arg">rchain</i> <i class="arg">expression</i></a></li>
<li><a href="#77"><b class="cmd">findUnrelatedWhere</b> <i class="arg">instref</i> <i class="arg">rchain</i> <i class="arg">expression</i></a></li>
<li><a href="#78"><b class="cmd">updateAttribute</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">attr1 value1 ...</i>?</span></a></li>
<li><a href="#79"><b class="cmd">withAttribute</b> <i class="arg">instref</i> <i class="arg">attrvarpair1</i> <span class="opt">?<i class="arg">attrvarpair2 attrvarpair3 ...</i>?</span> <i class="arg">body</i></a></li>
<li><a href="#80"><b class="cmd">readAttribute</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">attr1 attr2 ...</i>?</span></a></li>
<li><a href="#81"><b class="cmd">assignAttribute</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">attrvarpair1 attrvarpair2 ...</i>?</span></a></li>
<li><a href="#82"><b class="cmd">delete</b> <i class="arg"><span class="opt">?instref ...?</span></i></a></li>
<li><a href="#83"><b class="cmd">signal</b> <i class="arg">instref</i> <i class="arg">event</i> <span class="opt">?<i class="arg">param1 param2 ...</i>?</span></a></li>
<li><a href="#84"><b class="cmd">delaysignal</b> <i class="arg">time</i> <i class="arg">instref</i> <i class="arg">event</i> <span class="opt">?<i class="arg">param1 param2 ...</i>?</span></a></li>
<li><a href="#85"><b class="cmd">canceldelayed</b> <i class="arg">srcref</i> <i class="arg">dstref</i> <i class="arg">event</i></a></li>
<li><a href="#86"><b class="cmd">delayremaining</b> <i class="arg">srcref</i> <i class="arg">dstref</i> <i class="arg">event</i></a></li>
<li><a href="#87"><b class="cmd">instop</b> <i class="arg">instref</i> <i class="arg">operation</i> <span class="opt">?<i class="arg">arg1 arg2 ...</i>?</span></a></li>
</ul>
</div>
</div>
<div id="section1" class="section"><h2><a name="section1">Description</a></h2>
<p>This manpage describes the <b class="package">rosea</b> package.
<b class="package">Rosea</b> is a data and execution architecture for translating
XUML models using Tcl as the implementation language.</p>
</div>
<div id="section2" class="section"><h2><a name="section2">Package Commands</a></h2>
<p>The commands in this section are part of the ensemble command <b class="cmd">::rosea</b>.
Their use is to configure, generate and populate domains
and to control state machine tracing during run time.</p>
<dl class="definitions">
<dt><a name="1"><b class="cmd">::rosea configure</b> <i class="arg">script</i></a></dt>
<dd><p>The <b class="cmd">configure</b> command executes <i class="arg">script</i> as a Tcl script
in an environments where commands in <i class="arg">script</i> may be used to
define the characteristics of a XUML domain.
The configuration <i class="arg">script</i> should invoke Configuration Commands as
described <span class="sectref"><a href="#section3">below</a></span>.
The <b class="cmd">configure</b> command may be invoked multiple times
to accumulate the domain configuration information for an entire
application.
One typical arrangement is to invoke <b class="cmd">configure</b>
once for each domain in the application with with <i class="arg">script</i>
containing the definition of a single domain.</p></dd>
<dt><a name="2"><b class="cmd">::rosea configureFromChan</b> <i class="arg">channel</i></a></dt>
<dd><p>The <b class="cmd">configureFromChan</b> command executes the <b class="cmd">configure</b>
command on the script that is obtained by reading the contents of
<i class="arg">channel</i>.</p></dd>
<dt><a name="3"><b class="cmd">::rosea configureFromFile</b> <i class="arg">filename</i></a></dt>
<dd><p>The <b class="cmd">configureFromFile</b> command executes the <b class="cmd">configure</b>
command on the script that is contained in the file named, <i class="arg">filename</i>.</p></dd>
<dt><a name="4"><b class="cmd">::rosea generate</b> <span class="opt">?<i class="arg">pattern</i>?</span> <span class="opt">?<i class="arg">nsqual</i>?</span></a></dt>
<dd><p>The <b class="cmd">generate</b> command generates the architectural data and
command layout for all domains matching <i class="arg">pattern</i>.
If <i class="arg">pattern</i> is not given,
all configured domains are generated.
The domain is located in the namespace given by <i class="arg">nsqual</i> and
all domain commands will be qualified by <i class="arg">nsqual</i>.
If <i class="arg">nsqual</i> is not given,
the domains are generated in the global namespace.
If <i class="arg">nsqual</i> is supplied,
and it is not fully qualified, then it is taken to the
relative to the namespace of the caller.</p>
<p>Typically,
all domains are configured using the <b class="cmd">::rosea configure</b> command
and then <b class="cmd">generate</b> is invoked once to compute the required data
and create the domain commands.
It will most certainly cause an error to invoke <b class="cmd">generate</b> on
the same domain into the same namespace.</p></dd>
<dt><a name="5"><b class="cmd">::rosea populate</b> <i class="arg">script</i></a></dt>
<dd><p>The <b class="cmd">populate</b> command is used to populate the class data of
a domain from data.
The population <i class="arg">script</i> should invoke Population Commands as
described <span class="sectref"><a href="#section4">below</a></span>.</p></dd>
<dt><a name="6"><b class="cmd">::rosea populateFromChan</b> <i class="arg">channel</i></a></dt>
<dd><p>The <b class="cmd">populateFromChan</b> command executes the <b class="cmd">populate</b>
command on the script that is obtained by reading the contents of
<i class="arg">channel</i>.</p></dd>
<dt><a name="7"><b class="cmd">::rosea populateFromFile</b> <i class="arg">filename</i></a></dt>
<dd><p>The <b class="cmd">populateFromFile</b> command executes the <b class="cmd">populate</b>
command on the script that is contained in the file named, <i class="arg">filename</i>.</p></dd>
<dt><a name="8"><b class="cmd">::rosea save</b> <span class="opt">?-sqlite | -tclral?</span> <span class="opt">?-async <i class="arg">cmdprefix</i>?</span> <i class="arg">domain</i> <i class="arg">filename</i></a></dt>
<dd><p>The <b class="cmd">save</b> command serializes the domain data for the <i class="arg">domain</i>
into the file, <i class="arg">filename</i>.
The serialization technique may be specified as <i class="arg">-sqlite</i> or
<i class="arg">-tclral</i>.
If <i class="arg">-sqlite</i> is given,
then a SQLite database of the domain data is created.
By default or if <i class="arg">-tclral</i> is given,
then the native serialization of TclRAL is used.
Domains must be serialized outside of a transaction and so event
dispatch may continue after the invocation of the <b class="cmd">save</b> command.
If the <i class="arg">-async</i> option is given,
then <i class="arg">cmdprefix</i> is invoked when the serialization is completed.
The <i class="arg">cmdprefix</i> is invoked with two additional arguments, namely,
the <i class="arg">domain</i> and <i class="arg">filename</i> values.</p></dd>
<dt><a name="9"><b class="cmd">::rosea restore</b> <span class="opt">?-sqlite | -tclral?</span> <i class="arg">domain</i> <i class="arg">filename</i></a></dt>
<dd><p>The <b class="cmd">restore</b> command populates a domain from data values
saved by a previous invocation of the <b class="cmd">rosea save</b> command.
The serialization technique may be specified as <i class="arg">-sqlite</i> or
<i class="arg">-tclral</i>.
If <i class="arg">-sqlite</i> is given,
then a SQLite database of the domain data is assumed.
By default or if <i class="arg">-tclral</i> is given,
then the native serialization of TclRAL is assumed.
The data file format option must be the same as when the file was
saved.</p></dd>
<dt><a name="10"><b class="cmd">::rosea info</b> <i class="arg">subcommand</i> <i class="arg">arg1 arg2 ...</i></a></dt>
<dd><p>The <b class="cmd">info</b> returns information about rosea domains.
It takes a subcommand and arguments to return the requested information.
Valid forms of the command are:</p></dd>
<dt><a name="11"><b class="cmd">::rosea::info domain classes</b> <i class="arg">domainname</i></a></dt>
<dd><p>Returns a list of the classes in <i class="arg">domainname</i>.</p></dd>
<dt><a name="12"><b class="cmd">::rosea::info domain relationships</b> <i class="arg">domainname</i></a></dt>
<dd><p>Returns a list of the relationships in <i class="arg">domainname</i>.</p></dd>
<dt><a name="13"><b class="cmd">::rosea::info domain operations</b> <i class="arg">domainname</i></a></dt>
<dd><p>Returns a list of triples (i.e. the length of the returned list
will be a multiple of 3).
The triple consists of the domain operation name,
a list of the parameters and the body of the operation.</p></dd>
<dt><a name="14"><b class="cmd">::rosea::info classes attributes</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></dt>
<dd><p>Returns a list of doubles.
The double consists of the attribute name and data type
for the attributes of <i class="arg">classname</i>.</p></dd>
<dt><a name="15"><b class="cmd">::rosea::info classes classops</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></dt>
<dd><p>Returns a list of triples.
The triple consists of the class operation name,
a list of the parameters and the body of the operation.</p></dd>
<dt><a name="16"><b class="cmd">::rosea::info classes instops</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></dt>
<dd><p>Returns a list of triples.
The triple consists of the instance operation name,
a list of the parameters and the body of the operation.</p></dd>
<dt><a name="17"><b class="cmd">::rosea::info statemodel states</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></dt>
<dd><p>Returns a list of triples for the states of <i class="arg">classname</i>.
The triple consists of the state name,
a list of the parameters to the state and the body of the
state activity.</p></dd>
<dt><a name="18"><b class="cmd">::rosea::info statemodel events</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></dt>
<dd><p>Returns a list of event names for <i class="arg">classname</i>.</p></dd>
<dt><a name="19"><b class="cmd">::rosea::info statemodel transitions</b> <i class="arg">domainname</i> <i class="arg">classname</i></a></dt>
<dd><p>Returns a nested dictionary of the transition table for <i class="arg">classname</i>.
The first level keys are the state names.
The second level keys are the event names.
The value at the second level is the new state to which a transition
would be made or IG or CH for the ignored and error transitions.</p></dd>
<dt><a name="20"><b class="cmd">::rosea::info statemodel activityproc</b> <i class="arg">domainname</i> <i class="arg">classname</i> <i class="arg">statename</i></a></dt>
<dd><p>Returns the name of the Tcl proc that is the state activity for <i class="arg">statename</i>.</p></dd>
<dt><a name="21"><b class="cmd">::rosea tunnel</b> <i class="arg">instref</i> <i class="arg">operation</i> <span class="opt">?<i class="arg">arg1 arg2 ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">tunnel</b> command invokes the instance based operation, <i class="arg">op</i>,
on the instance given by <i class="arg">instref</i> from outside of a domain's
implementation.
The <i class="arg">argN</i> arguments are passed to the operation.
This procedure is intended primarily for bridging actions
external to domain, _e.g._ Tcl/Tk events,
onto an instance operation.
Consider the following command being run from within an
instance operation of some class.</p>
<pre class="example">
ttk::button .run -text Run -command [list ::rosea tunnel $self signal Run]
</pre>
<p>The effect here is to tie a Tk event through the button command
to the instance which invoked the above code.
In this way, the Tk event has been transformed into a state machine event
delivered from outside of the domain.</p></dd>
<dt><a name="22"><b class="cmd">::rosea trace</b> <i class="arg">subcmd</i> <span class="opt">?<i class="arg">value ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">trace</b> command controls and displays the result of tracing
state machine event dispatches.
Valid <i class="arg">subcmd</i> arguments are:</p>
<dl class="options">
<dt><b class="option"><b class="option">control</b> <i class="arg">ctrlopt value <span class="opt">?...?</span></i></b></dt>
<dd><p>The <b class="option">control</b> subcommand executes the trace control function indicated
by <i class="arg">ctrlopt</i>.
Valid values of <i class="arg">ctrlopt</i> are:</p>
<dl class="options">
<dt><b class="option"><b class="option">on</b></b></dt>
<dd><p>Turn trace collection on.</p></dd>
<dt><b class="option"><b class="option">off</b></b></dt>
<dd><p>Turn trace collection off.</p></dd>
<dt><b class="option"><b class="option">status</b></b></dt>
<dd><p>Returns the current status of tracing.</p></dd>
<dt><b class="option"><b class="option">clear</b></b></dt>
<dd><p>Discards all trace entries.</p></dd>
<dt><b class="option"><b class="option">logon</b></b></dt>
<dd><p>Log traces as they occur via the <b class="package">::logger</b> package.</p></dd>
<dt><b class="option"><b class="option">logoff</b></b></dt>
<dd><p>Turn trace logging off.</p></dd>
<dt><b class="option"><b class="option">loglevel</b> <i class="arg">level</i></b></dt>
<dd><p>Set the logging level for traces to <i class="arg">level</i>.</p></dd>
<dt><b class="option"><b class="option">save</b> <i class="arg">filename</i></b></dt>
<dd><p>Save all traces to a SQLite database.</p></dd>
</dl></dd>
<dt><b class="option"><b class="option">decode</b> <i class="arg">which</i></b></dt>
<dd><p>The <b class="option">decode</b> subcommand queries the set of collected state
machine traces according to the value of <i class="arg">which</i>
and returns a list of dictionaries that contain the selected trace information.
Valid values of <i class="arg">which</i> are:</p>
<dl class="options">
<dt><b class="option"><b class="option">all</b></b></dt>
<dd><p>Decode all trace entries.</p></dd>
<dt><b class="option"><b class="option">class</b> <i class="arg">class1 class2 ...</i></b></dt>
<dd><p>Decode only those trace entries for which the class of the
receiving instance matches one of the <i class="arg">classN</i> arguments.</p></dd>
<dt><b class="option"><b class="option">target</b> <i class="arg">instref1 instref2 ...</i></b></dt>
<dd><p>Decode only those trace entries for which the receiving instance matches
one of the <i class="arg">instrefN</i> arguments.</p></dd>
</dl></dd>
<dt><b class="option"><b class="option">format</b> <i class="arg">traces</i></b></dt>
<dd><p>Returns a human readable formatting of the <i class="arg">traces</i>.
The <i class="arg">traces</i> argument is a list of dictionaries as returned from
the <b class="cmd">::rosea trace decode</b> command.</p>
<pre class="example">
puts [rosea trace format [rosea trace decode all]]
</pre>
</dd>
<dt><b class="option"><b class="option">diagram</b> <i class="arg">which</i> <i class="arg">filename</i> <i class="arg"><span class="opt">?arg ...?</span></i></b></dt>
<dd><p>The <b class="option">diagram</b> subcommand queries a set of collected state
machine traces according to the value of <i class="arg">which</i>
and writes to <i class="arg">filename</i> a script suitable to be used with the
<a href="http://blockdiag.com/en/seqdiag/">seqdiag</a>
program to produce a UML sequence diagram of the traces.
Valid values of <i class="arg">which</i> are:</p>
<dl class="options">
<dt><b class="option"><b class="option">all</b> <i class="arg">filename</i></b></dt>
<dd><p>Diagram all trace entries.</p></dd>
<dt><b class="option"><b class="option">class</b> <i class="arg">filename</i> <i class="arg">classes</i> <i class="arg"><span class="opt">?option value ...?</span></i></b></dt>
<dd><p>Diagram only those trace entries for which the class of the
receiving instance matches one of the class names in the <i class="arg">classes</i> list.
Optional <i class="arg">option value</i> pairs are passed into the generated <b class="cmd">seqdiag</b>
script.</p></dd>
<dt><b class="option"><b class="option">target</b> <i class="arg">filename</i> <i class="arg">targetrefs</i> <i class="arg"><span class="opt">?option value ...?</span></i></b></dt>
<dd><p>Diagram only those trace entries for which the receiving instance matches
one of the instance references in the <i class="arg">targetrefs</i> list.
Optional <i class="arg">option value</i> pairs are passed into the generated <b class="cmd">seqdiag</b>
script.</p></dd>
</dl></dd>
</dl></dd>
</dl>
</div>
<div id="section3" class="section"><h2><a name="section3">Configuration Commands</a></h2>
<p>The commands in this section is used are intended to be invoked as part
of the <i class="arg">body</i> script of the <b class="cmd">configure</b> command.
There is only one command, <b class="cmd">domain</b>, and it is used to define
the elements of a domain.</p>
<dl class="definitions">
<dt><a name="23"><b class="cmd">domain</b> <i class="arg">name</i> <i class="arg">body</i></a></dt>
<dd><p>The <b class="cmd">domain</b> command executes <i class="arg">body</i> as a Tcl script in an environment
where the characteristics of the domain may be defined.
The domain is given <i class="arg">name</i> as a name which may not be the empty string.
The <i class="arg">body</i> of the domain configuration script should invoke
Domain Configuration Commands as
described <span class="sectref"><a href="#subsection1">below</a></span>.</p>
<pre class="example">
::rosea configure {
    domain mydomain {
        # Definition of &quot;mydomain&quot; is placed here.
    }
}
</pre>
</dd>
</dl>
<div id="subsection1" class="subsection"><h3><a name="subsection1">Domain Configuration Commands</a></h3>
<p>The commands in this section are intended to be invoked as part of the
<i class="arg">body</i> of the <b class="cmd">domain</b> command.
These commands specify the details of the various elements that
are part of a domain.</p>
<dl class="definitions">
<dt><a name="24"><b class="cmd">class</b> <i class="arg">name</i> <i class="arg">script</i></a></dt>
<dd><p>The <b class="cmd">class</b> command executes <i class="arg">script</i> as a Tcl script in an environment
where the characteristics of the class may be defined.
The class is given <i class="arg">name</i> as a name which may not be the empty string.</p>
<pre class="example">
class WashingMachine {
    # Place WashingMachine class definition here.
}
</pre>
</dd>
<dt><a name="25"><b class="cmd">association</b> <i class="arg">name</i> <i class="arg">source</i> <i class="arg">spec</i> <i class="arg">target</i> <span class="opt">?<i class="arg">option value ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">association</b> command defines a referential association called,
<i class="arg">name</i>, between
a <i class="arg">source</i> class and a <i class="arg">target</i> class.
The multiplicity and conditionality of the association is specified
by <i class="arg">spec</i>.
The <i class="arg">spec</i> argument must be a string from one of the following:</p>
<ul class="itemized">
<li><p>1--1</p></li>
<li><p>0..1--1 <em>or</em> ?--1</p></li>
<li><p>0..1--0..1 <em>or</em> ?--?</p></li>
<li><p>1..*--1 <em>or</em> +--1</p></li>
<li><p>0..*--1 <em>or</em> *--1</p></li>
<li><p>1..*--0..1 <em>or</em> +--?</p></li>
<li><p>0..*--0..1 <em>or</em> *--?</p></li>
<li><p>1..*--1..* <em>or</em> +--+</p></li>
<li><p>0..*--1..* <em>or</em> *--+</p></li>
<li><p>1..*--0..* <em>or</em> +--*</p></li>
<li><p>0..*--0..* <em>or</em> *--*</p></li>
</ul>
<p>Options must be one of the following:</p>
<dl class="options">
<dt><b class="option"><b class="option">-associator</b></b> <i class="arg">class</i></dt>
<dd><p>The <b class="option">-associator</b> option define the association to be
<em>class based</em> and specifies <i class="arg">class</i> as the association class.</p></dd>
<dt><b class="option"><b class="option">-path</b></b> <i class="arg">attribute_list</i></dt>
<dd><p>The <b class="option">-path</b> option defines the direction of reference for
class based reflexive associations.
The <i class="arg">attribute_list</i> argument is a list of attribute name pairs
that define the attribute correspondence when traversing the reflexive
association in the forward direction.</p></dd>
</dl>
<pre class="example">
association R1 ClothesTub 1--1 WashingMachine
association R47 Member 1..*--1..* Organization -associator Membership
</pre>
<p>In the example below,
the direction of <em>R1</em> is ambiguous since it is reflexive on <em>Element</em>
and is a class based association.
The <em>Group</em> associative class contains the referential attributes,
<em>PrevElem</em> and <em>NextElem</em> but we still need to state
that the forward direction of traversal is when values of <em>PrevElem</em> match
those of
<em>NextElem</em>.</p>
<pre class="example">
class Element {
    attribute ElemId string -id 1
}
class Group {
    attribute PrevElem string -id 1
    attribute NextElem string -id 1
    reference R1 Element -link {PrevElem ElemId} -link {NextElem ElemId}
}
association R1 Element 0..*--0..* Element -associator Group\ 
    -path {PrevElem NextElem}
</pre>
</dd>
<dt><a name="26"><b class="cmd">generalization</b> <i class="arg">name</i> <i class="arg">superclass</i> <i class="arg">subclass1</i> <i class="arg">subclass2 ...</i></a></dt>
<dd><p>The <b class="cmd">generalization</b> command defines <i class="arg">name</i> as a generalization
relationship where <i class="arg">superclass</i> is the superclass and the
<i class="arg">subclassN</i> arguments are the subclasses.
There must be at least two <i class="arg">subclass</i> arguments.</p>
<pre class="example">
generalization R27 Lamp FloorLamp TableLamp
</pre>
</dd>
<dt><a name="27"><b class="cmd">assigner</b> <i class="arg">association</i> <i class="arg">body</i></a></dt>
<dd><p>The <b class="cmd">assigner</b> command specifies that <i class="arg">association</i> is
to have a state model that will be used to link and unlink the association.
The <i class="arg">body</i> argument is a Tcl script that should invoke the
Assigner Configuration commands given
<span class="sectref"><a href="#subsection4">below</a></span>
to define characteristics of the assigner state model.</p></dd>
<dt><a name="28"><b class="cmd">operation</b> <i class="arg">name</i> <i class="arg">parameters</i> <i class="arg">body</i></a></dt>
<dd><p>The <b class="cmd">operation</b> command defines a domain based operation named,
<i class="arg">name</i>.
The <i class="arg">parameters</i> argument is a list of parameters to the operation
and is specified in the same manner as for the <b class="cmd">::proc</b> command.
The <i class="arg">body</i> argument is a Tcl script that is executed when the
operation is invoked.
All domain operations are realized as subcommands of the domain
ensemble command.</p></dd>
</dl>
</div>
<div id="subsection2" class="subsection"><h3><a name="subsection2">Class Configuration Commands</a></h3>
<p>The commands in this section are intended to be invoked as part of the
<i class="arg">body</i> script of the <b class="cmd">class</b> command.
These command define the characteristics a class such as its attributes.</p>
<dl class="definitions">
<dt><a name="29"><b class="cmd">attribute</b> <i class="arg">name</i> <i class="arg">datatype</i> <span class="opt">?<i class="arg">option value ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">attribute</b> command defines a attribute named, <i class="arg">name</i>,
for the enclosing class.
The <i class="arg">datatype</i> arguments specifies the data type
of the attribute and must be one of the data types accepted by the
<b class="package">::ral</b> package.
Valid options are:</p>
<dl class="options">
<dt><b class="option"><b class="option">-default</b></b> <i class="arg">value</i></dt>
<dd><p>The <b class="option">-default</b> option defines <i class="arg">value</i> to be the default
value for the attribute.
When class instances are created,
if no value for the attribute is given,
then the attribute is given the default <i class="arg">value</i>.</p></dd>
<dt><b class="option"><b class="option">-system</b></b> <i class="arg">start</i></dt>
<dd><p>The <b class="option">-system</b> option designates the attribute to have a
system supplied value by default.
System supplied values are sequential integers that begin at the
given <i class="arg">start</i> value and increment each time an instanced is created.</p></dd>
<dt><b class="option"><b class="option">-generate</b></b> <i class="arg">cmd</i></dt>
<dd><p>The <b class="option">-generate</b> options designates the attribute to have a
generated value by default.
The <i class="arg">cmd</i> is evaluated and its return value is used as
the default value of the attribute.</p></dd>
<dt><b class="option"><b class="option">-id</b></b> <i class="arg">number</i></dt>
<dd><p>The <b class="option">-id</b> specifies that the attribute is part of the identifier given
by <i class="arg">number</i>.
All classes must have at least one identifier.
Classes may have multiple identifiers and each is given a separate number.
Typically, <i class="arg">number</i> is a small integer such as 1, 2 or 3.</p></dd>
<dt><b class="option"><b class="option">-check</b></b> <i class="arg">expr</i></dt>
<dd><p>Check that values of the attribute satisfy <i class="arg">expr</i>.
<i class="arg">Expr</i> must
be suitable for the <b class="cmd">::expr</b> command and may reference variables
that are the same name as the attributes of the class.
Checks are made on a tuple-by-tuple basis during any insert or
update operation for the class instance.</p></dd>
</dl>
<pre class="example">
class WashingCycle {
    attribute CycleType string -id 1
    attribute WashWaterTemp string -default Cold
    attribute RinseWaterTemp string -default Cold
}
</pre>
</dd>
<dt><a name="30"><b class="cmd">reference</b> <i class="arg">relationship</i> <i class="arg">class</i> <span class="opt">?<i class="arg">option value ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">reference</b> command specifies that the enclosing class
is used to realize <i class="arg">relationship</i> to <i class="arg">class</i>
having attributes that refer to identifiers in <i class="arg">class</i>.
Valid options are:</p>
<dl class="options">
<dt><b class="option"><b class="option">-link</b></b> <i class="arg">attrmap</i></dt>
<dd><p>The <b class="option">-link</b> option specifies an attribute reference mapping.
The <i class="arg">attrmap</i> value is a one or two element list.
The first element is the name of an attribute in the enclosing class.
The second element is the name of an attribute in the class given
by the <i class="arg">class</i> argument.
The <b class="option">-link</b> option specifies that an attribute in the class being
defined is a reference to (<em>i.e.</em> will have the same value as)
an attribute in the <i class="arg">class</i> class.
If the second element of <i class="arg">attrmap</i> is missing,
then the name of the referenced attribute in <i class="arg">class</i> is assumed to be
the same as the referring attribute.
The link options must define a one-to-one correspondence between
referring attributes in the class being defined
and an identifier in <i class="arg">class</i>.
At least one <b class="option">-link</b> option must be given.
Multiple <b class="option">-link</b> options may be given for <i class="arg">relationship</i>
when the referenced identifier of <i class="arg">class</i> has more than one attribute.</p></dd>
<dt><b class="option"><b class="option">-refid</b></b> <i class="arg">number</i></dt>
<dd><p>The <b class="option">refid</b> option gives the <i class="arg">number</i> of the identifier to which
the reference is directed.
If missing, then <b class="option">-refid</b> defaults to 1.
Typically, references in the class being defined refer to the primary
identifier in <i class="arg">class</i>.
However, if they refer to another identifier, then the <b class="option">-refid</b>
option is necessary.
All the attributes given by the <b class="option">-link</b> options, as a group,
must reference a specific identifier in <i class="arg">class</i>.</p></dd>
</dl>
<pre class="example">
class WashingMachine {
    attribute MachineID string -id 1
    attribute CycleType string
    reference R4 WashingCycle -link CycleType
}
</pre>
</dd>
<dt><a name="31"><b class="cmd">classop</b> <i class="arg">name</i> <i class="arg">params</i> <i class="arg">body</i></a></dt>
<dd><p>The <b class="cmd">classop</b> command defines a class based operation for the
enclosing class named, <i class="arg">name</i>.
The <i class="arg">params</i> argument gives the formal parameters of the operation
and is specified in the same manner as for the <b class="cmd">::proc</b> command.
The <i class="arg">body</i> argument is a Tcl script what will be executed when the
<i class="arg">name</i> operation is invoked.
For each class based operation defined on a class,
a subcommand by the same name will be defined for the class ensemble command.</p>
<pre class="example">
class WashingMachine {
    classop new {} {
        # Construct the necessary class instances for a new washer.
    }
}
</pre>
</dd>
<dt><a name="32"><b class="cmd">instop</b> <i class="arg">name</i> <i class="arg">params</i> <i class="arg">body</i></a></dt>
<dd><p>The <b class="cmd">instop</b> command defines an instance based operation for
the enclosing class named, <i class="arg">name</i>.
The <i class="arg">params</i> argument gives the formal parameters of the operation
and is specified in the same was as for the <b class="cmd">::proc</b> command.
The <i class="arg">body</i> argument is a Tcl script what will be executed when the
<i class="arg">name</i> operation is invoked.
Instance based operations will have a <i class="arg">self</i> parameter automatically
added as the first argument
and can be invoked using the <b class="cmd">instop</b> instance command.</p></dd>
<dt><a name="33"><b class="cmd">statemodel</b> <i class="arg">body</i></a></dt>
<dd><p>The <b class="cmd">statemodel</b> command specifies that the enclosing class is to
also have a state model.
The <i class="arg">body</i> argument is a Tcl script that should invoke
the State Model Configuration commands given
<span class="sectref"><a href="#subsection3">below</a></span>
to define the characteristics of the class state model.</p>
<pre class="example">
class Vessel {
    # ... attribute definitions
    statemodel {
        # State model defined here
    }
}
</pre>
</dd>
<dt><a name="34"><b class="cmd">polymorphic</b> <span class="opt">?<i class="arg">event ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">polymorphic</b> command defines the <i class="arg">event</i> arguments to
be polymorphic events.
The <i class="arg">event</i> arguments are event names and the class being defined
must be the superclass of a generalization hierarchy.
Events defined as polymorphic are directed to a superclass instance
and then, at run-time, dispatched to the subclass instance to which
the target superclass instance is currently related.</p></dd>
</dl>
</div>
<div id="subsection3" class="subsection"><h3><a name="subsection3">State Model Configuration Commands</a></h3>
<p>The commands in this section are intended to be invoked as part of
the <i class="arg">body</i> script of the <b class="cmd">statemodel</b> command.
These command define the states, transitions, _etc._ of the state model that is
bound to the enclosing <b class="cmd">class</b>.</p>
<dl class="definitions">
<dt><a name="35"><b class="cmd">state</b> <i class="arg">name</i> <i class="arg">parameters</i> <i class="arg">body</i></a></dt>
<dd><p>The <b class="cmd">state</b> command defines a state named, <i class="arg">name</i>, in the enclosing
state model.
The <i class="arg">name</i> argument may not be <em>@</em>, <em>IG</em> or <em>CH</em>
nor is it allowed to be the empty string.
The <i class="arg">parameters</i> argument gives the parameters to the state the
are carried with the event that causes a transition into <i class="arg">state</i>.
The <i class="arg">parameters</i> are specified in the same manner as for the <b class="cmd">::proc</b>
command.
The <i class="arg">body</i> argument is a Tcl script that is executed when the
instance to which the state machine is associated enters <i class="arg">state</i>.
Every state has an implicit <b class="variable">self</b> parameter that is automatically
defined for the state and when <i class="arg">body</i> is invoked will have the value
of an instance reference to the instance receiving the event.</p>
<pre class="example">
state Idle {speed} {
    # Idle state activity code here
}
</pre>
</dd>
<dt><a name="36"><b class="cmd">transition</b> <i class="arg">source</i> <i class="arg">-</i> <i class="arg">event</i> <i class="arg">-&gt;</i> <i class="arg">target</i></a></dt>
<dd><p>The <b class="cmd">transition</b> command specifies that when an instance is currently
in the <i class="arg">source</i> state and receives <i class="arg">event</i> that it
will transition to the <i class="arg">target</i> state.
The <i class="arg">-</i> and <i class="arg">-&gt;</i> arguments are syntactic sugar and are ignored.
The <i class="arg">source</i> argument may be any state of the state model being defined
or the <i class="arg">@</i> state, signifying the pseudo-initial state used for
asynchronous instance creation.
The <i class="arg">target</i> argument may be any state of the state model or
one of the non-transitioning states, <em>IG</em> or <em>CH</em>.
If <i class="arg">target</i> is <em>IG</em> then the event is ignored.
If <i class="arg">target</i> is <em>CH</em> then the event is deemed as logically impossible
to happen in the <i class="arg">source</i> state and an error condition is raised.
The <i class="arg">event</i> argument is the name of an event and the set of events
to which the state model responds is taken as the union of all the
<i class="arg">event</i> names encountered in the <b class="cmd">transition</b> commands defining the
state model.</p>
<pre class="example">
transition Idle - Run -&gt; Running
transition Running - Stop -&gt; Idle
</pre>
</dd>
<dt><a name="37"><b class="cmd">initialstate</b> <i class="arg">name</i></a></dt>
<dd><p>The <b class="cmd">initialstate</b> command set the state named, <i class="arg">name</i>, to be
the initial state of the state model.
If no <b class="cmd">initialstate</b> command is invoked in the body of a <b class="cmd">statemodel</b>,
then name of the state given in the first invocation of the <b class="cmd">state</b>
command is deemed to be the initial state.</p></dd>
<dt><a name="38"><b class="cmd">defaulttrans</b> <i class="arg">CH | IG</i></a></dt>
<dd><p>The <b class="cmd">defaulttrans</b> command define the default transition target
for all state transition that are not explicitly defined using the
<b class="cmd">transition</b> command.
This allows for a minimal number of invocations of the <b class="cmd">transition</b>
command with all other transition target set to the default.
If the <b class="cmd">defaulttrans</b> command is not invoked in the body of a
<b class="cmd">statemodel</b>, then <em>CH</em> is deemed to be the default transition.</p></dd>
<dt><a name="39"><b class="cmd">terminal</b> <span class="opt">?<i class="arg">state ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">terminal</b> command specifies that <i class="arg">states</i> given as arguments
are to be deemed <em>terminal states</em>.
When an instance transitions into a terminal state and
after the execution of the state activity,
the instance is automatically deleted.</p></dd>
</dl>
</div>
<div id="subsection4" class="subsection"><h3><a name="subsection4">Assigner Configuration Commands</a></h3>
<p>The commands in this section are intended to be invoked as part of the
<i class="arg">body</i> script of the <b class="cmd">assigner</b> command.
These commands define the state model of the assigner and are similar
to the
State Model Configuration Commands
<span class="sectref"><a href="#subsection3">above</a></span>.</p>
<dl class="definitions">
<dt><a name="40"><b class="cmd">state</b> <i class="arg">name</i> <i class="arg">parameters</i> <i class="arg">body</i></a></dt>
<dd><p>The <b class="cmd">state</b> command for assigners has the same form and
meaning as for class state models.</p></dd>
<dt><a name="41"><b class="cmd">transition</b> <i class="arg">source</i> <i class="arg">-</i> <i class="arg">event</i> <i class="arg">-&gt;</i> <i class="arg">target</i></a></dt>
<dd><p>The <b class="cmd">transition</b> command for assigners has the same form and
meaning as for class state models.</p></dd>
<dt><a name="42"><b class="cmd">initialstate</b> <i class="arg">name</i></a></dt>
<dd><p>The <b class="cmd">initialstate</b> command for assigners has the same form and
meaning as for class state models.</p></dd>
<dt><a name="43"><b class="cmd">defaulttrans</b> <i class="arg">CH | IG</i></a></dt>
<dd><p>The <b class="cmd">defaulttrans</b> command for assigners has the same form and
meaning as for class state models.</p></dd>
<dt><a name="44"><b class="cmd">identifyby</b> <i class="arg">class</i> <span class="opt">?<i class="arg">-id number</i>?</span></a></dt>
<dd><p>The <b class="cmd">identifyby</b> command specifies that the assigner being defined
is a multiple assigner and instances of the assigner are to be
identified by the identifier of the class named, <i class="arg">class</i>.
Valid options are:</p>
<dl class="options">
<dt><b class="option"><b class="option">-id</b></b> <i class="arg">number</i></dt>
<dd><p>The <b class="option">-id</b> option causes the identifier numbered, <i class="arg">number</i>,
of <i class="arg">class</i> to be the identifier of the multiple assigner.
If the <b class="option">-id</b> option is missing, then the default is <b class="option">-id 1</b>.</p></dd>
</dl></dd>
</dl>
</div>
</div>
<div id="section4" class="section"><h2><a name="section4">Population Commands</a></h2>
<p>The commands in this section are intended to be invoked as part of the
<i class="arg">body</i> script of the <b class="cmd">::rosea populate</b> command.
These commands define class instance values that are to be part of the
initial instance population for the domain.
Population commands should only be invoked after the domain
has been generated.
It is only at that time that the data storage has been create to
hold the class instances.</p>
<dl class="definitions">
<dt><a name="45"><b class="cmd">domain</b> <i class="arg">name</i> <i class="arg">body</i></a></dt>
<dd><p>The <b class="cmd">domain</b> command executes <i class="arg">body</i> as a Tcl script in order
to populate the <i class="arg">name</i> domain.
Commands in <i class="arg">body</i> should invoke Domain Population Commands
as described
<span class="sectref"><a href="#subsection5">below</a></span>.</p>
<pre class="example">
::rosea populate {
    domain mydomain {
        # Initial population of &quot;mydomain&quot; is placed here.
    }
}
</pre>
</dd>
</dl>
<div id="subsection5" class="subsection"><h3><a name="subsection5">Domain Population Commands</a></h3>
<p>The commands in this section are intended to be invoked as part of the
<i class="arg">body</i> script of the <b class="cmd">domain</b> command which is, in turn,
part of a script for defining an initial instance population.</p>
<dl class="definitions">
<dt><a name="46"><b class="cmd">class</b> <i class="arg">name</i> <i class="arg">heading</i> <i class="arg">values ...</i></a></dt>
<dd><p>The <b class="cmd">class</b> command creates instances of the <i class="arg">name</i> class.
The <i class="arg">heading</i> is a list of attribute names for the <i class="arg">name</i> class.
Attributes that have been given default values need not be present.
Otherwise, it is necessary to supply a value for all attributes
when an instance is created.
Instances are created by assigning, in order, values to the corresponding
attribute.
If there is only a single <i class="arg">value</i> argument,
it is treated as a list.
This treatment is convenient when constant values are assigned to the
attributes.
For a single <i class="arg">value</i> argument or if many are given,
the number of values must be a multiple of the number of attributes
in the <i class="arg">heading</i>.
If the value given an attribute is the literal string &quot;-&quot;, then
the attribute is not populated and will receive its default value.
To give an attribute a value of &quot;-&quot; it must be escaped as &quot;\-&quot;.</p>
<p>This example shows how using a list can layout constant values in a
convenient tabular form.</p>
<pre class="example">
    class WashingMachine {
        MachineID       CycleType} {
        M1              Normal
        M2              PermPress
        M3              Delicate
    }
</pre>
<p>When values need to be calculated or substituted,
it can be more convenient to use multiple <i class="arg">value</i> arguments.</p>
<pre class="example">
    class WashingMachine {
        MachineID           CycleType}\ 
        M[incr cnt]         Normal\ 
        M[incr cnt]         PermPress\ 
        M[incr cnt]         Delicate\ 
</pre>
</dd>
<dt><a name="47"><b class="cmd">assigner</b> <i class="arg">association</i> <i class="arg">heading</i> <i class="arg">values ...</i></a></dt>
<dd><p>The <b class="cmd">assigner</b> command is used to create instances of the
multiple assigner that has been defined on <i class="arg">association</i>.
The <i class="arg">heading</i> is a list of attribute names and must match
the attributes of the identifying class as given by the <b class="cmd">identifyby</b>
command when the assigner was specified.
The <i class="arg">values</i> arguments are treated in the same manner
as for the <b class="cmd">class</b> populate command.</p></dd>
</dl>
</div>
</div>
<div id="section5" class="section"><h2><a name="section5">Architecture Commands</a></h2>
<p>The commands in this section are supplied by <b class="cmd">rosea</b>.
They are intended to be invoked by state activities and
operations and provide the means to access model level
semantics in the implementation.</p>
<p>Many of the commands below accept as an argument
or return as a value an <em>instance reference</em>.
An instance reference or <i class="arg">instref</i>,
is an ordinary Tcl value whose internals should be considered opaque.
An instance reference provides a means to refer to zero or more
class instances.
The primary purpose of the instance reference is to specify which
class instances are to be subject to an operation or
to specify the results of some operation on the class model as a whole,
<em>e.g.</em> finding a set of instances based on some attribute value.</p>
<div id="subsection6" class="subsection"><h3><a name="subsection6">Class Commands</a></h3>
<p>Each class in a domain will have a class command defined for it.
The class command has the same name as the class and is an ensemble
command whose subcommands are given below.
The subcommands listed below are included in the class ensemble command
for all classes in the domain.
In addition,
any class based operations defined for the class will also
appear as additional subcommands in the class command ensemble.</p>
<dl class="definitions">
<dt><a name="48"><i class="arg">class</i> <b class="cmd">findAll</b></a></dt>
<dd><p>The <b class="cmd">findAll</b> command returns an instance reference that refers to
all the instances of <i class="arg">class</i>.</p>
<pre class="example">
set wms [WashingMachine findAll]
</pre>
</dd>
<dt><a name="49"><i class="arg">class</i> <b class="cmd">findById</b> <i class="arg">idattr1 idvalue1 ...</i></a></dt>
<dd><p>The <b class="cmd">findById</b> command returns an instance reference that refers to
at most one instance of <i class="arg">class</i> whose identifier matches that
given by the attribute name / value argument pairs.
If no instance matches the attribute name / value arguments,
then the returned instance reference is an empty reference
(<em>i.e.</em> one where
invoking the <b class="cmd">isEmptyRef</b> command would return <em>true</em>).</p>
<pre class="example">
set wc [WashingCycle findById CycleType Normal]
</pre>
</dd>
<dt><a name="50"><i class="arg">class</i> <b class="cmd">findWhere</b> <i class="arg">expression</i></a></dt>
<dd><p>The <b class="cmd">findWhere</b> command
returns an instance reference to instances of <i class="arg">class</i> where
<i class="arg">expression</i> evaluates to true.
During the evaluation of <i class="arg">expression</i>,
the attributes of each tuple in <i class="arg">class</i> are assigned into Tcl
variables of the same name and <i class="arg">expression</i> may reference those
variables in determining the selection of tuples.</p>
<pre class="example">
set hotcycles [WashingCycle findWhere {$WashWaterTemp eq &quot;Hot&quot;}]
</pre>
</dd>
<dt><a name="51"><i class="arg">class</i> <b class="cmd">create</b> <i class="arg">attr1 value1 attr2 value2 ...</i></a></dt>
<dd><p>The <b class="cmd">create</b> command creates an instance of <i class="arg">class</i>.
The attributes of the class will be set
according to the attribute name / value pairs given as arguments.
All attributes must be given a value unless a particular attribute
was configured to have a default value.
In that case,
if attribute is not included in the arguments,
its default value will be used instead.
If <i class="arg">class</i> has an associated state model,
then the newly created instance will be placed in the default initial state.
However, no state activity is executed.
The command returns a reference to the newly created instance.</p>
<pre class="example">
set wm [WashingMachine create MachineID washer2 CycleType Normal]
</pre>
</dd>
<dt><a name="52"><i class="arg">class</i> <b class="cmd">createin</b> <i class="arg">state</i> <i class="arg">attr1 value1 attr2 value2 ...</i></a></dt>
<dd><p>The <b class="cmd">createin</b> command creates an instance of <i class="arg">class</i>
and places the newly created instance into the <i class="arg">state</i> state.
No state activity is executed.
It is an error to invoke <b class="cmd">createin</b> if <i class="arg">class</i> does not have
an associated state machine.
The attributes of the class will be set
according to the attribute names / value pairs given as arguments.
All attributes must be given a value unless a particular attribute
was configured to have a default value.
In that case,
the attribute need not be included in the arguments and its default
value will be used instead.
The command returns a reference to the newly created instance.</p>
<pre class="example">
set wm [WashingMachine createin Washing MachineID washer2 CycleType Normal]
</pre>
</dd>
<dt><a name="53"><i class="arg">class</i> <b class="cmd">createasync</b> <i class="arg">event</i> <i class="arg">eventparams</i> <i class="arg">attr1 value1 attr2 value2 ...</i></a></dt>
<dd><p>The <b class="cmd">createasync</b> command signals a creation event for <i class="arg">class</i>
When dispatched,
a new instance of <i class="arg">class</i> is created.
The attributes of the class will be set
according to the attribute names / value pairs given as arguments.
All attributes must be given a value unless a particular attribute
was configured to have a default value.
In that case,
the attribute need not be included in the arguments and its default
value will be used instead.
After creating the class instance,
<i class="arg">event</i> along with the event parameters given by
<i class="arg">eventparams</i> is dispatched to the newly created instance.
<i class="arg">Eventparams</i> is interpreted as a list of parameter values that
must match the parameter signature of the state into which <i class="arg">event</i>
causes a transition.
It is an error to invoke <b class="cmd">createasync</b> if <i class="arg">class</i> does not have
an associated state machine or if <i class="arg">class</i> does not have a
transition specified to originate from the pseudo-initial state
of &quot;@&quot;.
The command returns the empty string.</p>
<pre class="example">
set r [Reactor createasync Process {300 20} VesselId A270]
</pre>
</dd>
<dt><a name="54"><i class="arg">class</i> <b class="cmd">update</b> <i class="arg">relationvalue</i></a></dt>
<dd><p>The <b class="cmd">update</b> command updates into <i class="arg">class</i> all the non-identifying
attributes contained in <i class="arg">relationvalue</i>.
One way to modify attribute values as a set is to dereference a set
of instances, perform a series of operations via the <b class="cmd">ral relation</b>
command to yield a new relation value that is then used to update
the instances of <i class="arg">class</i>.</p>
<p>In the example below,
assume that the <i class="arg">ref</i> variable contains an instance reference
to a class, <i class="arg">Vessel</i>, that has attributes <i class="arg">Temp</i> and <i class="arg">Volume</i>,
the following code will add 10 to the <i class="arg">Temp</i> and double the <i class="arg">Volume</i>
for all instances referred to by <i class="arg">ref</i></p>
<pre class="example">
Vessel update [relation update [deRef $ref Temp Volume] newtuple {1} {
    tuple update $newtuple\ 
        Temp [expr {[tuple extract $newtuple Temp] + 10}]\ 
        Volume [expr {[tuple extract $newtuple Volume] * 2.0}]
}]
</pre>
<p>The <b class="cmd">update</b> command may also be used with an extend / eliminate / rename
strategy for computing a set of changes to the instance attributes.</p>
<pre class="example">
Vessel update [pipe {
    deRef $ref Temp Volume |
    relation extend ~ newtuple\ 
        NewTemp double {[tuple extract $newtuple Temp] + 10}\ 
        NewVolume double {[tuple extract $newtuple Volume] * 2.0} |
    relation eliminate ~ Temp Volume |
    relation rename ~ NewTemp Temp NewVolume Volume
}]
</pre>
</dd>
</dl>
</div>
<div id="subsection7" class="subsection"><h3><a name="subsection7">Relationship Commands</a></h3>
<p>Each relationship in a domain will have a relationship command defined
for it.
The relationship command has the same name as the relationship
and is an ensemble command whose subcommands are given below.
The subcommands of a relationship ensemble command will depend upon
the type of the relationship and not all of the subcommands below
are available to all relationships.
How each command applies to a relationship is described below.</p>
<dl class="definitions">
<dt><a name="55"><i class="arg">relationship</i> <b class="cmd">link</b> <i class="arg">instref1</i> <i class="arg">instref2</i></a></dt>
<dd><p>The <b class="cmd">link</b> command will associate the class instances given
by <i class="arg">instref1</i> and <i class="arg">instref2</i> across the <i class="arg">relationship</i>
relationship.
<i class="arg">Relationship</i> must be a simple relationship (i.e. not a class
based association).
The linkage is accomplished by updating the referential attributes
of the instances of one class to have the same values as the
corresponding identifier in the other class.
The referring and referenced class instances may be given in either
order.
For those cases where the relationship is defined to have a
multiplicity greater than one,
the instance reference for the referring instances may have a multiplicity
greater than one and all the references instances will be linked.</p>
<pre class="example">
set wm [WashingMachine create MachineId 5 CycleType {}]
set wc [WashingCycle findById CycleType Normal]
R4 link $wm $wc
</pre>
</dd>
<dt><a name="56"><i class="arg">relationship</i> <b class="cmd">link</b> <i class="arg">instref1</i> <i class="arg">instref2</i> <span class="opt">?<i class="arg">attr1 value1 attr2 value2 ...</i>?</span></a></dt>
<dd><p>For class based associations,
the <b class="cmd">link</b> command will create an instance of the associator class
setting the values of the referential attributes to be those of the
identifiers of <i class="arg">instref1</i> and <i class="arg">instref2</i>.
If the associator class has attributes other than the referential ones,
then the attribute values must be given as arguments
in the form of attribute name / value pairs.
Any additional attributes that have defined default values may be omitted.
It is possible for <i class="arg">instref1</i> and / or <i class="arg">instref2</i> to reference
multiple instances.
In such a case,
all possible links
(and consequently multiple instances of the associator class)
will be created.
The return value of the command is an instance reference to the
new created associator class instances.</p></dd>
<dt><a name="57"><i class="arg">relationship</i> <b class="cmd">unlink</b> <i class="arg">instref</i></a></dt>
<dd><p>The <b class="cmd">unlink</b> command unlinks the class instances referenced by
<i class="arg">instref</i> from the association relationship given by <i class="arg">relationship</i>.</p>
<pre class="example">
set wm [WashingMachine findById MachineID 5]
R4 unlink $wm
</pre>
</dd>
<dt><a name="58"><i class="arg">relationship</i> <b class="cmd">migrate</b> <i class="arg">instref</i> <i class="arg">subclass</i> <span class="opt">?<i class="arg">attr1 value1 attr2 value2 ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">migrate</b> migrates the subclass instance referenced by
<i class="arg">instref</i> to be an instance of the subclass named, <i class="arg">subclass</i>.
The <b class="cmd">migrate</b> command is supplied only for generalization relationships.
The instance referenced by <i class="arg">instref</i> is deleted and a
corresponding new instance of <i class="arg">subclass</i> is created.
If the instance of <i class="arg">subclass</i> has additional attributes other
than the referential identifiers,
those attributes values must be given as <i class="arg">attrN</i> / <i class="arg">valueN</i> pairs.
The return value of the command is an instance reference to the
newly created instance of <i class="arg">subclass</i>.</p>
<pre class="example">
set lamp [Lamp create SerialNo 223 Color Red]
set tablelamp [TableLamp create SerialNo 223 Height 30]
set floorlamp [R7 migrate $tablelamp FloorLamp Material brass Weight 15]
</pre>
</dd>
<dt><a name="59"><i class="arg">relationship</i> <b class="cmd">signal</b> <i class="arg">event</i> <span class="opt">?<i class="arg">param1 param2 ...</i>?</span></a></dt>
<dd><p>For associations that have a single assigner state model,
the <b class="cmd">signal</b> command is used to signal <i class="arg">event</i> to the assigner
state machine of <i class="arg">relationship</i>.
Any optional event parameters are given by the <i class="arg">paramN</i> arguments.</p></dd>
<dt><a name="60"><i class="arg">relationship</i> <b class="cmd">signal</b> <i class="arg">idvalues</i> <i class="arg">event</i> <span class="opt">?<i class="arg">param1 param2 ...</i>?</span></a></dt>
<dd><p>For associations that have a multiple assigner state model,
the <b class="cmd">signal</b> command is used to signal <i class="arg">event</i> to the assigner
state machine identified by <i class="arg">idvalues</i>.
The <i class="arg">idvalues</i> argument is a dictionary whose keys are the attributes
names of the assigner identifier and whose corresponding values
match those of some assigner for <i class="arg">relationship</i>.
Any optional event parameters are given by the <i class="arg">paramN</i> arguments.</p></dd>
<dt><a name="61"><i class="arg">relationship</i> <b class="cmd">create</b> <span class="opt">?<i class="arg">attr1 value1 attr2 value2 ...</i>?</span></a></dt>
<dd><p>For associations that have a multiple assigner state model,
the <b class="cmd">create</b> command creates an instance of the assigner
that is identified by the <i class="arg">attrN</i> / <i class="arg">valueN</i> names and values.</p></dd>
</dl>
</div>
<div id="subsection8" class="subsection"><h3><a name="subsection8">Instance Commands</a></h3>
<p>The commands below define operations on class instances.
They are intended to be invoked as part of state activities and operations
to access the data model and signal events.
The context in which a state activity runs is such that these
commands will resolve using unqualified command names.</p>
<dl class="definitions">
<dt><a name="62"><b class="cmd">deRef</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">attr1 attr2 ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">deRef</b> command returns a relation value containing the
class instances referred to by <i class="arg">instref</i>.
If no <i class="arg">attrN</i> arguments are given,
then the heading of the returned relation value contains all the
class attributes.
Otherwise, supplying <i class="arg">attr</i> names will result in the returned
relation value having only the given attributes plus a set of
identifying attributes.</p></dd>
<dt><a name="63"><b class="cmd">nilInstRef</b></a></dt>
<dd><p>The <b class="cmd">nilInstRef</b> command returns an instance reference that does
not refer to any instance.
Note that the nil instance reference is different from an empty
instance reference.
The later refers to no instances of some particular class.
The nil instance reference refers to no instances of no class
and is not equal to any instance reference other than itself.
This command has very limited utility such as when it is necessary
to cancel a delayed event that was signaled outside of a state activity.
In that case,
the nil instance reference is considered the source
of the event.</p></dd>
<dt><a name="64"><b class="cmd">isEmptyRef</b> <i class="arg">instref</i></a></dt>
<dd><p>The <b class="cmd">isEmptyRef</b> command returns true if <i class="arg">instref</i> refers to
no instances and false otherwise.</p></dd>
<dt><a name="65"><b class="cmd">isNotEmptyRef</b> <i class="arg">instref</i></a></dt>
<dd><p>The <b class="cmd">isNotEmptyRef</b> command returns true if <i class="arg">instref</i> refers to
any instances and false otherwise.</p></dd>
<dt><a name="66"><b class="cmd">refMultiplicity</b> <i class="arg">instref</i></a></dt>
<dd><p>The <b class="cmd">refMultiplicity</b> command returns the number of instances referenced
by <i class="arg">instref</i>.</p></dd>
<dt><a name="67"><b class="cmd">isRefSingular</b> <i class="arg">instref</i></a></dt>
<dd><p>The <b class="cmd">isRefSingular</b> command returns true if <i class="arg">instref</i> refers to
exactly one instance and false otherwise.</p></dd>
<dt><a name="68"><b class="cmd">limitRef</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">count</i>?</span></a></dt>
<dd><p>The <b class="cmd">limitRef</b> command returns a new instance reference that
refers to at most <i class="arg">count</i> instances.
If the <i class="arg">count</i> argument is missing, then the returned instance reference
refers to at most one instance.</p></dd>
<dt><a name="69"><b class="cmd">isRefEqual</b> <i class="arg">instref1</i> <i class="arg">instref2</i></a></dt>
<dd><p>The <b class="cmd">isRefEqual</b> command returns true if <i class="arg">instref1</i> and <i class="arg">instref2</i>
both refers to the same instances and false otherwise.</p></dd>
<dt><a name="70"><b class="cmd">refUnion</b> <i class="arg">instref1</i> <i class="arg">instref2</i></a></dt>
<dd><p>The <b class="cmd">refUnion</b> command computes the set union of the two instance
references given as arguments.</p></dd>
<dt><a name="71"><b class="cmd">refIntersect</b> <i class="arg">instref1</i> <i class="arg">instref2</i></a></dt>
<dd><p>The <b class="cmd">refIntersect</b> command computes the set intersection of the two instance
references given as arguments.</p></dd>
<dt><a name="72"><b class="cmd">refMinus</b> <i class="arg">instref1</i> <i class="arg">instref2</i></a></dt>
<dd><p>The <b class="cmd">refMinus</b> command computes the set differenct of <i class="arg">instref1</i>
minus <i class="arg">instref2</i>.</p></dd>
<dt><a name="73"><b class="cmd">forAllRefs</b> <i class="arg">varname</i> <i class="arg">instref</i> <i class="arg">script</i></a></dt>
<dd><p>The <b class="cmd">forAllRefs</b> command iterates across all the instances referred
to by <i class="arg">instref</i>.
It assigns a singular instance reference into <i class="arg">varname</i> and then
executes <i class="arg">script</i>.</p></dd>
<dt><a name="74"><b class="cmd">findRelated</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">relationship1 relationship2 ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">findRelated</b> command traverses a relationship chain starting
at <i class="arg">instref</i> finding all the instances of those classes which
are the target of the traversal along the path given by the
<i class="arg">relationshipN</i> arguments.
Each <i class="arg">relationshipN</i> argument is treated as a one or two element list.
If a single element, then it is the name of a relationship (<em>e.g.</em> R27)
that is to be traversed in the forward direction or the
name of a relationship prefixed by a tilde (<em>e.g.</em> ~R27) giving the
name of a relationship to be traversed in its reverse direction.
If a two element list, then the traversal may have alternate paths
and the second element names the class that is to be the destination
of the traversal.
For class based associations this would be the name of the associator class
and for generalizations this would be the name of one of the subclasses.</p>
<p>The return value of <b class="cmd">findRelated</b> is an instance reference to
a set of instances for the class that is the ultimate destination of
the relationship chain.</p>
<pre class="example">
set inst [findRelated $self R1 {~R2 Sub} ~R3]
</pre>
</dd>
<dt><a name="75"><b class="cmd">findUnrelated</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">relationship1 relationship2 ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">findUnrelated</b> command traverses a relationship chain starting
at <i class="arg">instref</i> finding all the instances of those classes that are <em>not</em>
related which are the target of the traversal along the path given by the
<i class="arg">relationshipN</i> arguments.
The <i class="arg">relationshipN</i> arguments are specified in the same manner
as for the <b class="cmd">findRelated</b> command.</p>
<p>The return value of <b class="cmd">findUnrelated</b> is an instance reference to
a set of instances that are <em>not</em> related to the
instances referenced by <i class="arg">instref</i> along the relationship navigation chain.</p></dd>
<dt><a name="76"><b class="cmd">findRelatedWhere</b> <i class="arg">instref</i> <i class="arg">rchain</i> <i class="arg">expression</i></a></dt>
<dd><p>The <b class="cmd">findRelatedWhere</b> command traverses a relationship chain given by
<i class="arg">rchain</i> starting at <i class="arg">instref</i> finding all the instances of
those classes which are the target of the traversal along the path.
The result of the traversal is further filtered by returning a reference
only to those instances where <i class="arg">expression</i> evaluates to true.
The <i class="arg">rchain</i> argument is a list of relationship traversals as
described for the <b class="cmd">findRelated</b> command.
During the evaluation of the <i class="arg">expression</i> the values of each attribute
are assigned to Tcl variables that are the same name as the attribute.
These values may be referenced in the <i class="arg">expression</i> and provide a
means of selecting instances based on their attribute values.</p>
<p>The return value of <b class="cmd">findRelatedWhere</b> is an instance reference to
a set of instances for the class that is the ultimate destination of
the relationship chain and for which <i class="arg">expression</i> evaluates to true.</p>
<pre class="example">
set wv [findRelatedWhere $self ~R3 {$ValveID eq &quot;Drain&quot;}]
</pre>
</dd>
<dt><a name="77"><b class="cmd">findUnrelatedWhere</b> <i class="arg">instref</i> <i class="arg">rchain</i> <i class="arg">expression</i></a></dt>
<dd><p>The <b class="cmd">findUnrelatedWhere</b> command operates the same as the
<b class="cmd">findRelatedWhere</b> command except that it returns a reference to
those instances that are <em>not</em> related to the instances
referenced by <i class="arg">instref</i>.</p></dd>
<dt><a name="78"><b class="cmd">updateAttribute</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">attr1 value1 ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">updateAttribute</b> command updates the <i class="arg">attrN</i> attributes
to the corresponding <i class="arg">valueN</i> value for all the class instances referenced
by <i class="arg">instref</i>.</p>
<p>The return value of <b class="cmd">updateAttribute</b> is the empty string.</p>
<pre class="example">
set wc [WashingCycle findById CycleType Normal]
updateAttribute $wc SpinDuration 20 SpinSpeed high
</pre>
</dd>
<dt><a name="79"><b class="cmd">withAttribute</b> <i class="arg">instref</i> <i class="arg">attrvarpair1</i> <span class="opt">?<i class="arg">attrvarpair2 attrvarpair3 ...</i>?</span> <i class="arg">body</i></a></dt>
<dd><p>The <b class="cmd">withAttribute</b> command assigns the values of the
attributes referenced by <i class="arg">instref</i> and given by
<i class="arg">attrvarpairN</i> arguments into the corresponding Tcl variables and
evaluates <i class="arg">body</i>.
The <i class="arg">instref</i> must refer to only a single instance.
After <i class="arg">body</i> executes,
the values of the assigned attributes are updated back into the class.
Each <i class="arg">attrvarpairN</i> argument is interpreted as a two element list.
The first element is the name of an attribute and the second element
is the name of a variable into which the attribute value is assigned.
If the second element is missing,
then the attribute value is assigned into a Tcl variable that is named the
same as the attribute.
Attributes may not be identifying attributes.
If any variable to which an attribute value was assigned is <b class="cmd">unset</b>
during the execution of <i class="arg">body</i>,
then that attribute is not updated after <i class="arg">body</i> completes.</p>
<pre class="example">
withAttribute $self Count {
    incr Count
}
</pre>
</dd>
<dt><a name="80"><b class="cmd">readAttribute</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">attr1 attr2 ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">readAttribute</b> command returns the values of zero or more
attributes of the instance referenced by <i class="arg">instref</i>.
The <i class="arg">instref</i> reference must be singular.
If no <i class="arg">attrN</i> arguments are given,
the return value is the empty string.
If only one attribute argument is given,
then a simple scalar value is returned.
If multiple attribute arguments are given,
then a list of values is returned.
The order of the returned list corresponds to the order of
the <i class="arg">attrN</i> arguments.</p>
<pre class="example">
set wc [WashingCycle findById CycleType Normal]
set duration [readAttribute $wc SpinDuration]
</pre>
</dd>
<dt><a name="81"><b class="cmd">assignAttribute</b> <i class="arg">instref</i> <span class="opt">?<i class="arg">attrvarpair1 attrvarpair2 ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">assignAttribute</b> command assigns the values of the instance
referenced by <i class="arg">instref</i> into Tcl variables.
The <i class="arg">instref</i> reference must be singular.
If no <i class="arg">attrvarpairN</i> arguments are given,
then all the attributes of the instance are assigned to Tcl variables
whose names are the same as the attribute names.
If any <i class="arg">attrvarpairN</i> arguments are present,
then each argument is interpreted as a two element list.
The first element is the name of an attribute and the second element
is the name of a variable into which the attribute value is assigned.
If the second element is missing,
then the attribute value is assigned into a Tcl variable that is named the
same as the attribute.</p>
<pre class="example">
set wc [WashingCycle findById CycleType Normal]
assignAttribute $wc {SpinDuration spin} {WashWaterTemp wwtemp}
if {$wwtemp &gt; 100} {
    puts &quot;we're in hot water&quot;
}
</pre>
</dd>
<dt><a name="82"><b class="cmd">delete</b> <i class="arg"><span class="opt">?instref ...?</span></i></a></dt>
<dd><p>The <b class="cmd">delete</b> command deletes all the class instances referenced by
the <i class="arg">instrefN</i> arguments.</p></dd>
<dt><a name="83"><b class="cmd">signal</b> <i class="arg">instref</i> <i class="arg">event</i> <span class="opt">?<i class="arg">param1 param2 ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">signal</b> command sends the event named, <i class="arg">event</i>,
to all the class instances referenced by <i class="arg">instref</i>.
If any optional <i class="arg">paramN</i> parameters are supplied they are send as
parameters of the event.
It is a corollary of the rules of Moore type state machines that
any event that causes a transition into a state must supply any
parametric event data defined by the signature of the state activity.
Failing to do so will result in a runtime error when the event is dispatched.</p>
<pre class="example">
set wm [WashingMachine findById MachineId 27]
signal $wm Start
</pre>
</dd>
<dt><a name="84"><b class="cmd">delaysignal</b> <i class="arg">time</i> <i class="arg">instref</i> <i class="arg">event</i> <span class="opt">?<i class="arg">param1 param2 ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">delaysignal</b> command sends the event named, <i class="arg">event</i>,
to all the class instances referenced by <i class="arg">instref</i>
at least <i class="arg">time</i> milliseconds in the future..
If any optional <i class="arg">paramN</i> parameters are supplied they are send as
parameters of the event.</p>
<pre class="example">
set wm [WashingMachine findById MachineId 27]
delaysignal 100 $wm Start
</pre>
</dd>
<dt><a name="85"><b class="cmd">canceldelayed</b> <i class="arg">srcref</i> <i class="arg">dstref</i> <i class="arg">event</i></a></dt>
<dd><p>The <b class="cmd">canceldelayed</b> command cancels the outstanding <i class="arg">event</i>
between the instance referred to by <i class="arg">srcref</i> and all the instances
referred to by <i class="arg">dstref</i>.
If there are not outstanding <i class="arg">event</i> events between the referenced
instanced,
then no action is taken and no error is generated.</p></dd>
<dt><a name="86"><b class="cmd">delayremaining</b> <i class="arg">srcref</i> <i class="arg">dstref</i> <i class="arg">event</i></a></dt>
<dd><p>The <b class="cmd">delayremaining</b> command returns the number of milliseconds
until <i class="arg">event</i> is signaled from <i class="arg">srcref</i> to <i class="arg">dstref</i>.
The returned value will be zero if the <i class="arg">event</i> does not exist
or has already been signaled.</p></dd>
<dt><a name="87"><b class="cmd">instop</b> <i class="arg">instref</i> <i class="arg">operation</i> <span class="opt">?<i class="arg">arg1 arg2 ...</i>?</span></a></dt>
<dd><p>The <b class="cmd">instop</b> command invokes an instance based operation,
<i class="arg">operation</i>, on the class instance referenced by <i class="arg">instref</i>.
The options <i class="arg">argN</i> arguments are passed to the operation.</p></dd>
</dl>
</div>
</div>
<div id="copyright" class="section"><h2><a name="copyright">Copyright</a></h2>
<p>Copyright &copy; 2014-2015 by G. Andrew Mangogna</p>
</div>
</div></body></html>
